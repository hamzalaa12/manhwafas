# ุญููู ูุดููุฉ "ุงููุงูุฌุง ุบูุฑ ููุฌูุฏุฉ"

## ๐ ุงููุดููุฉ

```
Error fetching manga details: ุงููุงูุฌุง ุบูุฑ ููุฌูุฏุฉ
```

## ๐ ุงูุชุดุฎูุต ุงููุญุชูู

ุงููุดููุฉ ุชุญุฏุซ ุนูุฏูุง:

1. ุงููุงูุฌุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ุชุญุชูู ุนูู `slug`
2. ูุธุงู ุงูู slug ูู ูุชู ุชุทุจููู ุจุงููุงูู ุนูู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ
3. ููุงู ุชุจุงูู ุจูู ุงูู slugs ุงููููุฏุฉ ูุงููุญููุธุฉ

## โ ุงูุญููู ุงููุทุจูุฉ

### 1. ุชุญุณูู Debug Logging

**ุงููุฏู**: ููู ุณุจุจ ุนุฏู ุงูุนุซูุฑ ุนูู ุงููุงูุฌุง

**ุงููุถุงู**:

```typescript
// ูู MangaDetails.tsx
console.log("Looking for manga with identifier:", identifier);
console.log("Sample available manga:", availableManga);

// ูู MangaCard.tsx
console.log("MangaCard debug:", { slug, title, id, mangaSlug, url });
```

### 2. ุฅุถุงูุฉ Fallback ููุจุญุซ ุจุงูุนููุงู

**ุงููุฏู**: ุฅุฐุง ูู ูุฌุฏ ุจุงูู slugุ ูุจุญุซ ุจุงูุนููุงู

```typescript
if (error.code === "PGRST116" && identifier.type === "slug") {
  // ุงูุจุญุซ ุจุงูุนููุงู ูู fallback
  const { data: titleData } = await supabase
    .from("manga")
    .select("*")
    .ilike("title", `%${identifier.value.replace(/-/g, " ")}%`)
    .limit(1);
}
```

### 3. ุฅูุดุงุก ุฏูุงู ุฅุตูุงุญ Slugs

**ุงูููู**: `src/utils/fixSlugs.ts`

**ุงููุธุงุฆู**:

- `fixMissingSlugs()`: ุฅุถุงูุฉ slugs ูููุงูุฌุง ุงูุชู ูุง ุชุญุชูู ุนูููุง
- `checkDatabaseHealth()`: ูุญุต ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

```typescript
// ุชุญุฏูุซ ุงููุงูุฌุง ุงูุชู ูุง ุชุญุชูู ุนูู slug
for (const manga of mangaWithoutSlugs) {
  const baseSlug = createSlug(manga.title);
  let finalSlug = baseSlug;

  // ุงูุชุฃูุฏ ูู ุฃู ุงูู slug ูุฑูุฏ
  while (await slugExists(finalSlug)) {
    counter++;
    finalSlug = `${baseSlug}-${counter}`;
  }

  await updateMangaSlug(manga.id, finalSlug);
}
```

### 4. ุฃุฏูุงุช ุฅุฏุงุฑูุฉ ููุฅุตูุงุญ

#### ุฃ) ุฒุฑ ูู ุตูุญุฉ ุงูุฎุทุฃ (ููุฃุฏูู)

```tsx
{
  isAdmin && (
    <Button
      onClick={async () => {
        await fixMissingSlugs();
        window.location.reload();
      }}
    >
      ุฅุตูุงุญ Slugs
    </Button>
  );
}
```

#### ุจ) ุฒุฑ ูู AdminPanel

```tsx
<Button onClick={handleFixSlugs}>
  <Settings className="h-5 w-5 ml-2" />
  ุฅุตูุงุญ Slugs
</Button>
```

### 5. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

**ุงูุฅุถุงูุงุช**:

- ุนุฑุถ ุงููุงูุฌุง ุงููุชุงุญุฉ ุนูุฏ debugging
- ุฑุณุงุฆู ุฎุทุฃ ุฃูุซุฑ ูุถูุญุงู
- fallback ููุจุญุซ ุจุทุฑู ูุฎุชููุฉ

## ๐๏ธ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุทูุฑูู:

1. ุงูุชุญ Console ูู ุงููุชุตูุญ
2. ุงูุชูู ูุฃู ูุงูุฌุง ุชุธูุฑ ุงูุฎุทุฃ
3. ุฑุงุฌุน ุงูู logs ูููู ุงููุดููุฉ:
   ```
   Looking for manga with identifier: {type: "slug", value: "some-manga"}
   Sample available manga: [...]
   Database state: {totalManga: X, mangaWithSlugs: Y}
   ```

### ููุฃุฏูู:

1. **ูู ุตูุญุฉ ุงูุฎุทุฃ**: ุงุถุบุท "ุฅุตูุงุญ Slugs"
2. **ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ**: ุงุถุบุท ุฒุฑ "ุฅุตูุงุญ Slugs" ูู ุงูุฒุงููุฉ
3. **ุงูุชุญูู ูู ุงููุชุงุฆุฌ**: ุฑุงุฌุน console ููุชุฃูุฏ ูู ุงูุฅุตูุงุญ

## ๐ง ุฎุทูุงุช ุงูุฅุตูุงุญ ุงูุชููุงุฆู

### ๏ฟฝ๏ฟฝุง ุชูุนูู ุฏุงูุฉ `fixMissingSlugs()`:

1. **ุงูุจุญุซ**: ุชุฌุฏ ุฌููุน ุงููุงูุฌุง ุจุฏูู slug
2. **ุงูุชูููุฏ**: ุชูุดุฆ slug ูู ุงูุนููุงู
3. **ุงูุชุญูู**: ุชุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ slug ูุดุงุจู
4. **ุงูุชุญุฏูุซ**: ุชุญูุธ ุงูู slug ุงูุฌุฏูุฏ
5. **ุงูุชูุฑูุฑ**: ุชุนุฑุถ ุงููุชุงุฆุฌ ูู console

### ูุซุงู ุนูู ุงููุชุงุฆุฌ:

```
Checking for manga without slugs...
Found 15 manga without slugs
Updated "ุณููู ูููููุฌ" with slug: solo-leveling
Updated "ูุฌูู ุงูุนูุงููุฉ" with slug: attack-on-titan
Updated "ูุงุฑูุชู" with slug: naruto
...
Finished fixing slugs!
```

## ๐ ูุฑุงูุจุฉ ุงูุญุงูุฉ

### ุฏุงูุฉ `checkDatabaseHealth()` ุชุนุฑุถ:

```javascript
{
  totalManga: 50,           // ุฅุฌูุงูู ุงููุงูุฌุง
  mangaWithSlugs: 35,       // ุงููุงูุฌุง ุงูุชู ุชุญุชูู ุนูู slug
  mangaWithoutSlugs: 15     // ุงููุงูุฌุง ุงูุชู ุชุญุชุงุฌ ุฅุตูุงุญ
}
```

## ๐ ุงูููุงุฆุฏ

### ูุจู ุงูุฅุตูุงุญ:

- โ ุงููุงูุฌุง ุจุฏูู slug ูุง ุชุธูุฑ
- โ ุฑูุงุจุท ูุนุทูุฉ
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุฆุฉ
- โ ุตุนูุจุฉ ูู ุงูุชุดุฎูุต

### ุจุนุฏ ุงูุฅุตูุงุญ:

- โ ุฌููุน ุงููุงูุฌุง ููุง slugs ูุฑูุฏุฉ
- โ ุงูุฑูุงุจุท ุชุนูู ุจุดูู ุตุญูุญ
- โ fallback ููุจุญุซ ุจุงูุนููุงู
- โ ุฃุฏูุงุช ุฅุฏุงุฑูุฉ ูุฅุตูุงุญ ุงููุดุงูู
- โ logging ููุตู ููุชุดุฎูุต

## ๐ฎ ุงูููุงูุฉ ุงููุณุชูุจููุฉ

### ุงูุชุฃูุฏ ูู ุนุฏู ุชูุฑุงุฑ ุงููุดููุฉ:

1. **Auto-generation**: ุงูู slugs ุชูููุฏ ุชููุงุฆูุงู ูููุงูุฌุง ุงูุฌุฏูุฏุฉ
2. **Database triggers**: triggers ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุถูุงู ุงูู uniqueness
3. **Validation**: ุงูุชุญูู ูู ุงูู slug ูุจู ุงูุญูุธ
4. **Monitoring**: ูุฑุงูุจุฉ ุฏูุฑูุฉ ูุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ููุงุญุธุงุช ูููุฉ

### ูููุทูุฑูู:

- ุฑุงุฌุน console logs ุฏุงุฆูุงู ุนูุฏ ููุงุฌูุฉ ูุดุงูู
- ุงุณุชุฎุฏู `checkDatabaseHealth()` ููุชุญูู ุงูุฏูุฑู
- ุงูู fallback ูุนูู ููุจุญุซ ุจุงูุนููุงู ููุท

### ููุฃุฏูู:

- ุฒุฑ "ุฅุตูุงุญ Slugs" ุขูู ููุง ูุญุฐู ุจูุงูุงุช
- ูููู ุชุดุบููู ุนุฏุฉ ูุฑุงุช ุจุฃูุงู
- ุณูุธูุฑ ุชูุฑูุฑ ูู console ุจุงููุชุงุฆุฌ

### ูููุณุชุฎุฏููู:

- ุงููุดููุฉ ุณุชูุญู ุชููุงุฆูุงู ุจุนุฏ ุงูุฅุตูุงุญ
- ุงูุฑูุงุจุท ุงููุฏููุฉ ุณุชุนูู ุจุดูู ุทุจูุนู
- ูุง ุญุงุฌุฉ ูุฃู ุฅุฌุฑุงุก ูู ุฌุงูุจูู
